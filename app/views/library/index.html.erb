<!-- Header -->
<header class="bg-white shadow-sm border-b border-gray-200">
  <div class="max-w-7xl mx-auto px-6">
    <div class="flex items-center justify-between h-16">
      <div class="flex items-center space-x-8">
        <div class="flex items-center space-x-3">
          <% if current_institution&.logo&.attached? %>
            <%= image_tag current_institution.logo, alt: "#{current_institution.name.titleize} Logo", class: "h-10 w-10" %>
          <% else %>
            <div class="w-10 h-10 bg-brand-500 rounded-lg flex items-center justify-center">
              <i class="fas fa-graduation-cap text-white text-lg"></i>
            </div>
          <% end %>
          <div>
            <h1 class="font-serif font-bold text-xl text-gray-900"><%= current_institution&.name&.titleize || "University of Wulse" %></h1>
            <p class="text-xs text-gray-600">Digital Library</p>
          </div>
        </div>
        <nav class="hidden md:flex space-x-6">
          <span class="text-gray-700 hover:text-brand-500 font-medium cursor-pointer">Browse</span>
          <span class="text-gray-700 hover:text-brand-500 font-medium cursor-pointer">Collections</span>
          <span class="text-gray-700 hover:text-brand-500 font-medium cursor-pointer">Departments</span>
          <span class="text-gray-700 hover:text-brand-500 font-medium cursor-pointer">About</span>
        </nav>
      </div>
      <div class="flex items-center space-x-4">
        <button class="text-gray-600 hover:text-brand-500">
          <i class="fas fa-bookmark text-lg"></i>
        </button>
        <%= link_to "Sign In", new_session_path, class: "bg-brand-500 text-white px-4 py-2 rounded-lg hover:bg-brand-600 transition-colors" %>
      </div>
    </div>
  </div>
</header>

<!-- Search Header -->
<section class="bg-white border-b border-gray-200 py-6">
  <div class="max-w-7xl mx-auto px-6">
    <div class="max-w-4xl mx-auto">
      <%= form_with url: library_path, method: :get, class: "relative" do |f| %>
        <%= f.text_field :search, value: @search_term, placeholder: "Search documents...", class: "w-full px-6 py-3 text-lg border-2 border-gray-300 rounded-xl focus:border-brand-500 focus:outline-none pl-14" %>
        <i class="fas fa-search absolute left-5 top-1/2 transform -translate-y-1/2 text-gray-400 text-lg"></i>
        <%= f.submit "Search", class: "absolute right-3 top-1/2 transform -translate-y-1/2 bg-brand-500 text-white px-6 py-2 rounded-lg hover:bg-brand-600 transition-colors cursor-pointer" %>
      <% end %>
      <div class="flex items-center space-x-4 mt-4">
        <span class="text-sm text-gray-600">Quick filters:</span>
        <button class="bg-brand-500 text-white px-4 py-2 rounded-lg text-sm">All</button>
        <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm hover:bg-gray-300">Articles</button>
        <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm hover:bg-gray-300">Theses</button>
        <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm hover:bg-gray-300">Journals</button>
      </div>
    </div>
  </div>
</section>

<!-- Search Results -->
<div class="max-w-7xl mx-auto px-6 py-8">
  <div class="flex gap-8">
    <!-- Sidebar Filters -->
    <aside class="w-80 flex-shrink-0">
      <div class="bg-white rounded-lg border border-gray-200 p-6">
        <h3 class="font-semibold text-gray-900 mb-4">Refine Results</h3>

        <!-- Document Type -->
        <div class="mb-6">
          <h4 class="font-medium text-gray-700 mb-3">Document Type</h4>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded" checked>
              <span class="ml-2 text-sm text-gray-600">Articles (1,247)</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded" checked>
              <span class="ml-2 text-sm text-gray-600">Theses (342)</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded">
              <span class="ml-2 text-sm text-gray-600">Journals (189)</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded">
              <span class="ml-2 text-sm text-gray-600">Books (67)</span>
            </label>
          </div>
        </div>

        <!-- Department -->
        <div class="mb-6">
          <h4 class="font-medium text-gray-700 mb-3">Department</h4>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded" checked>
              <span class="ml-2 text-sm text-gray-600">Computer Science (892)</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded">
              <span class="ml-2 text-sm text-gray-600">Engineering (234)</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded">
              <span class="ml-2 text-sm text-gray-600">Mathematics (156)</span>
            </label>
          </div>
        </div>

        <!-- Publication Year -->
        <div class="mb-6">
          <h4 class="font-medium text-gray-700 mb-3">Publication Year</h4>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded" checked>
              <span class="ml-2 text-sm text-gray-600">2024 (234)</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded" checked>
              <span class="ml-2 text-sm text-gray-600">2023 (456)</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded">
              <span class="ml-2 text-sm text-gray-600">2022 (389)</span>
            </label>
          </div>
        </div>

        <!-- Language -->
        <div>
          <h4 class="font-medium text-gray-700 mb-3">Language</h4>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded" checked>
              <span class="ml-2 text-sm text-gray-600">English (1,456)</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" class="text-brand-500 rounded">
              <span class="ml-2 text-sm text-gray-600">Spanish (89)</span>
            </label>
          </div>
        </div>
      </div>
    </aside>

    <!-- Results Content -->
    <main class="flex-1">
      <!-- Results Header -->
      <div class="flex items-center justify-between mb-6">
        <div>
          <h2 class="text-2xl font-bold text-gray-900">Search Results</h2>
          <p class="text-gray-600"><%= @pagy.count %> documents found<%= " for \"#{@search_term}\"" if @search_term.present? %></p>
        </div>
        <div class="flex items-center space-x-4">
          <span class="text-sm text-gray-600">Sort by:</span>
          <select class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
            <option>Relevance</option>
            <option>Publication Date</option>
            <option>Title</option>
            <option>Author</option>
          </select>
          <div class="flex border border-gray-300 rounded-lg">
            <button class="p-2 bg-brand-500 text-white rounded-l-lg">
              <i class="fas fa-list"></i>
            </button>
            <button class="p-2 text-gray-500 hover:bg-gray-100 rounded-r-lg">
              <i class="fas fa-th"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Search Results List -->
      <div class="space-y-6">
        <% @documents.each do |document| %>
          <div class="bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow">
            <div class="flex items-start justify-between mb-4">
              <div class="flex items-center space-x-3">
                <span class="bg-brand-100 text-brand-700 px-3 py-1 rounded-full text-sm font-medium">Document</span>
                <span class="text-sm text-gray-500"><%= document.staff&.name || "Unknown Author" %></span>
                <span class="text-sm text-gray-500">•</span>
                <span class="text-sm text-gray-500"><%= document.created_at.year %></span>
              </div>
              <div class="flex items-center space-x-2">
                <button class="text-gray-400 hover:text-brand-500">
                  <i class="fas fa-bookmark"></i>
                </button>
                <button class="text-gray-400 hover:text-brand-500">
                  <i class="fas fa-share-alt"></i>
                </button>
              </div>
            </div>
            <h3 class="text-xl font-semibold text-gray-900 mb-2 cursor-pointer hover:text-brand-500">
              <%= document.name %>
            </h3>
            <p class="text-gray-600 mb-3">
              <%= truncate(document.name, length: 200) %>
            </p>
            <div class="flex items-center justify-between">
              <div class="flex items-center space-x-4 text-sm text-gray-500">
                <span><%= document.staff&.name || "Unknown" %></span>
                <span>•</span>
                <span><%= time_ago_in_words(document.updated_at) %> ago</span>
              </div>
              <% if document.document.attached? %>
                <%= link_to rails_blob_path(document.document, disposition: "attachment"), class: "bg-brand-500 text-white px-4 py-2 rounded-lg hover:bg-brand-600 transition-colors text-sm" do %>
                  <i class="fas fa-download mr-2"></i>Download PDF
                <% end %>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>

      <!-- Pagination -->
      <div class="flex items-center justify-between mt-8 pt-6 border-t border-gray-200">
        <div class="text-sm text-gray-600">
          Showing <%= @pagy.from %> to <%= @pagy.to %> of <%= @pagy.count %> results
        </div>
        <div class="flex items-center space-x-2">
          <% if @pagy.prev %>
            <%= link_to library_path(page: @pagy.prev, search: @search_term), class: "px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100" do %>
              <i class="fas fa-chevron-left"></i>
            <% end %>
          <% else %>
            <span class="px-3 py-2 border border-gray-300 rounded-lg text-gray-500">
              <i class="fas fa-chevron-left"></i>
            </span>
          <% end %>

          <% @pagy.series.each do |item| %>
            <% if item.is_a?(Integer) %>
              <%= link_to item, library_path(page: item, search: @search_term), class: "px-3 py-2 #{item == @pagy.page ? 'bg-brand-500 text-white' : 'border border-gray-300 text-gray-700 hover:bg-gray-100'} rounded-lg" %>
            <% elsif item == :gap %>
              <span class="px-2 text-gray-500">...</span>
            <% end %>
          <% end %>

          <% if @pagy.next %>
            <%= link_to library_path(page: @pagy.next, search: @search_term), class: "px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100" do %>
              <i class="fas fa-chevron-right"></i>
            <% end %>
          <% else %>
            <span class="px-3 py-2 border border-gray-300 rounded-lg text-gray-500">
              <i class="fas fa-chevron-right"></i>
            </span>
          <% end %>
        </div>
      </div>
    </main>
  </div>
</div>

<!-- Footer -->
<footer class="bg-gray-900 text-white py-12 mt-16">
  <div class="max-w-7xl mx-auto px-6">
    <div class="grid md:grid-cols-4 gap-8">
      <div>
        <div class="flex items-center space-x-3 mb-4">
          <div class="w-10 h-10 bg-brand-500 rounded-lg flex items-center justify-center">
            <i class="fas fa-graduation-cap text-white text-lg"></i>
          </div>
          <div>
            <h4 class="font-serif font-bold text-lg"><%= current_institution&.name&.titleize || "University of Wulse" %></h4>
            <p class="text-sm text-gray-400">Digital Library</p>
          </div>
        </div>
        <p class="text-gray-400 text-sm">Advancing knowledge through accessible research and academic excellence.</p>
      </div>
      <div>
        <h5 class="font-semibold mb-4">Quick Links</h5>
        <ul class="space-y-2 text-sm text-gray-400">
          <li><span class="hover:text-white transition-colors cursor-pointer">Browse Collections</span></li>
          <li><span class="hover:text-white transition-colors cursor-pointer">Advanced Search</span></li>
          <li><span class="hover:text-white transition-colors cursor-pointer">Submit Research</span></li>
          <li><span class="hover:text-white transition-colors cursor-pointer">Help & Support</span></li>
        </ul>
      </div>
      <div>
        <h5 class="font-semibold mb-4">Departments</h5>
        <ul class="space-y-2 text-sm text-gray-400">
          <li><span class="hover:text-white transition-colors cursor-pointer">Computer Science</span></li>
          <li><span class="hover:text-white transition-colors cursor-pointer">Medicine</span></li>
          <li><span class="hover:text-white transition-colors cursor-pointer">Environmental Science</span></li>
          <li><span class="hover:text-white transition-colors cursor-pointer">Mathematics</span></li>
        </ul>
      </div>
      <div>
        <h5 class="font-semibold mb-4">Contact</h5>
        <ul class="space-y-2 text-sm text-gray-400">
          <li>library@<%= current_institution&.subdomain || "wulse" %>.edu</li>
          <li>+1 (555) 123-4567</li>
          <li>123 University Ave<br>Wulse, ST 12345</li>
        </ul>
      </div>
    </div>
    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-sm text-gray-400">
      <p>&copy; <%= Time.current.year %> <%= current_institution&.name&.titleize || "University of Wulse" %>. All rights reserved.</p>
    </div>
  </div>
</footer>
