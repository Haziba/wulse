<div class="bg-white rounded-lg border border-gray-200 p-6">
  <h3 class="font-semibold text-gray-900 mb-4">Refine Results</h3>

  <% filters.each do |filter_key, filter_values| %>
    <div id="filter-category-<%= filter_key %>" class="mb-6" data-controller="filter-list library-search">
      <div class="flex items-center justify-between mb-3">
        <h4 class="font-medium text-gray-700"><%= filter_key.to_s.humanize %></h4>
        <div class="flex gap-2 text-xs">
          <a href="#" class="text-brand-500 hover:text-brand-600" data-action="click->library-search#selectAll">All</a>
          <span class="text-gray-400">|</span>
          <a href="#" class="text-brand-500 hover:text-brand-600" data-action="click->library-search#selectNone">None</a>
        </div>
      </div>
      <div class="space-y-2">
        <% filter_values.each do |value, count| %>
          <%
            filter_param_key = filter_key.to_s
            is_checked = params[filter_param_key].nil? || params[filter_param_key].include?(value)
          %>
          <label class="flex items-center" data-filter-list-target="item">
            <input type="checkbox"
                    class="text-brand-500 rounded"
                    data-library-search-target="checkbox"
                    data-param="<%= filter_param_key %>"
                    name="<%= filter_param_key %>[]"
                    value="<%= value %>"
                    <%= 'checked' if is_checked %>
                    data-action="change->library-search#search">
            <span class="ml-2 text-sm text-gray-600"><%= value.titleize %> (<%= number_with_delimiter(count) %>)</span>
          </label>
        <% end %>
      </div>
      <button type="button"
              class="mt-2 text-sm text-brand-500 hover:text-brand-600 font-medium hidden"
              data-filter-list-target="toggle"
              data-action="click->filter-list#toggle">
        Show all
      </button>
    </div>
  <% end %>
</div>